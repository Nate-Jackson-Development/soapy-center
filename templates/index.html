<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home Access Center</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <style>
        body {
            background-color: #212529;
            color: white;
        }
        
        .padded {
            padding-left: 15px;
            padding-top: 10px;
        }
    </style>
</head>
<body>
    {% include 'inc/nav.html' %}

    <center>
        <h1><i class="fas fa-home"></i> Home Access</h1>
    </center>
    <br>
    
    <div class="accordion" id="accordionExample">
        {% for key, value in data.items() %}
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#{{ key[0:5] }}" style="background-color: rgb(61, 59, 59); color: white;">
                    {{ key }} | {{ value }}
                    </button>
                </h2>
                <div id="{{ key[0:5] }}" class="accordion-collapse collapse">
                    <div class="accordion-body">
                        <table class="table table-dark table-striped">
                            <thead>
                                <tr>
                                    <th>Assignment Name</th>
                                    <th>Assignment Grade</th> 
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td></td>
                                    <td></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        {% endfor %}
      </div>
      <br>
      {% include 'inc/footer.html' %}

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>
    <script src="https://kit.fontawesome.com/de5215728b.js" crossorigin="anonymous"></script>
    <script>
        async function main() {
            var classes = await document.querySelectorAll('.accordion-header').length;
            var ii = 30;
            var i = 1;
            var someplace = document.getElementsByTagName("tbody");
            while (i <= classes) {
                var assignments = await fetch('http://64.121.162.77:5000/api/v1/' + (i - 1) + '/Assignments');
                var dumpedAssignments = await assignments.json();
                //console.log(dumpedAssignments);
                var points = await fetch('http://64.121.162.77:5000/api/v1/points/' + (i - 1))
                var dumpedPoints = await points.json();

                for (var assig in dumpedAssignments) {
                    var a = someplace[(i - 1)];
                    var points = dumpedPoints[assig];
                    var assigSplit = dumpedAssignments[assig].split("^");
                    //console.log(assigSplit);
                    var row = document.createElement("tr");
                    var name = document.createElement("td");
                    var grade = document.createElement("td");

                    name.innerText = assigSplit[0];

                    //grade.innerText = assigSplit[1];
                    grade.innerText = points + " (" + assigSplit[1] + ")";

                    a.appendChild(row);
                    row.appendChild(name);
                    row.appendChild(grade);
                    ii++;
                }

                i++;
            }
            
        }


            /*

            var assignmentAmounts = await fetch('http://64.121.162.77:5000/api/v1/assignmentAmounts')
                .then(async function(res) {
                    var a = await res.json();
                    console.log(a);
                    for (var num in a) {
                    }
                });

            while (i <= classes) {

                i++;
            }
            
            //await console.log(a);
            var i = 1;
            var urls = [];
            while (i <= a) {
                urls.push('http://64.121.162.77:5000/assignment/class/' + (i - 1));
                i++;
            }
            //console.log(urls);
            var someplace = document.getElementsByTagName("tbody");
            for (var i in urls) {
                //console.log(urls[i]);
                const response = await fetch(urls[i]);
                //await console.log(response);
                const wait = await response.json();
                console.log(wait);
                //await console.log(wait);
                for (var k = 0; k < wait; k++) {
                    //console.log(wait[k]);
                    console.log(k);
                    try{
                        var res = await fetch("http://64.121.162.77:5000/class/" + i + "/" + k);
                        var x = await res.json();
                        console.log(x);
                        //for (var j in someplace) {
                            //console.log(someplace[i]);
                            var a = someplace[i];                        
        
                        
                            var row = await document.createElement("tr");
                            var name = await document.createElement("td");
                            var grade = await document.createElement("td");
                            name.innerText = x[0];
                            grade.innerText = x[1];
                            await a.appendChild(row);
                            await row.appendChild(name);
                            await row.appendChild(grade);
                        //}
                    }
                    catch {
                        
                }
            }
            k = 0;




            //const url = 'http://64.121.162.77:5000/assignment/class/'
            //const response = await fetch(url, {"Access-Control-Allow-Origin": "*"});
            //const wait = await response.json();

            await console.log(wait);
            for (var i in wait) {
                let a = wait[i].split(":");
                console.log(a);
                let create = await document.createElement("tr");
                let createSecond = await document.createElement("td");
                let createThird = await document.createElement("td");
                createSecond.innerText = a[0];
                createThird.innerText = a[1];
                var someplace = document.getElementById("tbody");
                await someplace.appendChild(create);
                await create.appendChild(createSecond);
                await create.appendChild(createThird);
            } */
        main();
    </script>

</body>
</html>